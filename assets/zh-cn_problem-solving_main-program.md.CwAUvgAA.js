import{_ as p,D as r,c as l,j as s,I as t,w as o,a as e,a4 as i,o as n}from"./chunks/framework.B-8VqrsT.js";const c="/mspcm-docs/assets/missing-runtime.BrO7frFP.png",d="/mspcm-docs/assets/reparing.BW6z_O3E.png",h="/mspcm-docs/assets/failed-to-repair.DkhcEtst.png",m="/mspcm-docs/assets/EdgeWebView2-Setup.B7zx4ThN.png",g="/mspcm-docs/assets/modify.BbwF411U.png",_="/mspcm-docs/assets/repair-EdgeWebView2.Bf8iJ6k2.png",k="/mspcm-docs/assets/EdgeWebView2.B0o3ZNpQ.png",f="/mspcm-docs/assets/something-happened-on-our-end.BE5o4XeL.png",u="/mspcm-docs/assets/download-failure.CwEPGVnQ.png",E="/mspcm-docs/assets/unable-to-load-service.CuJt2DvS.png",b="/mspcm-docs/assets/unable-to-proceed.CgmMUc8s.png",w="/mspcm-docs/assets/start-service.8sBEhgEw.png",B="/mspcm-docs/assets/restart-service.B_Re5jxJ.png",W="/mspcm-docs/assets/cleanup.BSlgibnX.png",F="/mspcm-docs/assets/startmenu-right-click.tMSS4j58.png",S="/mspcm-docs/assets/Windows-11.g8hDVTyF.png",C="/mspcm-docs/assets/Windows-10.DenmO1kr.png",y="/mspcm-docs/assets/Windows-others.s_GTpf4M.png",P="/mspcm-docs/assets/Beta.DeMMGvQS.png",M="/mspcm-docs/assets/not-implemented.B2Sfswi7.png",D="/mspcm-docs/assets/close-startup.xjDVmkts.png",A="/mspcm-docs/assets/updates.JQaKbS9w.png",v="/mspcm-docs/assets/next.BvKoA8hk.png",x="/mspcm-docs/assets/hide-updates.UNo6_kTQ.png",V="/mspcm-docs/assets/select.BKERch_y.png",q="/mspcm-docs/assets/finish.D35J1FIk.png",T="/mspcm-docs/assets/blocked.CocIc1Qd.png",is=JSON.parse('{"title":"主程序使用问题","description":"","frontmatter":{},"headers":[],"relativePath":"zh-cn/problem-solving/main-program.md","filePath":"zh-cn/problem-solving/main-program.md","lastUpdated":1722831606000}'),N={name:"zh-cn/problem-solving/main-program.md"},R=i('<h1 id="主程序使用问题" tabindex="-1">主程序使用问题 <a class="header-anchor" href="#主程序使用问题" aria-label="Permalink to &quot;主程序使用问题&quot;">​</a></h1><h2 id="抱歉-微软电脑管家缺少关键的组件" tabindex="-1">抱歉，微软电脑管家缺少关键的组件 <a class="header-anchor" href="#抱歉-微软电脑管家缺少关键的组件" aria-label="Permalink to &quot;抱歉，微软电脑管家缺少关键的组件&quot;">​</a></h2><p>问题图例：</p><p><img src="'+c+'" alt=""></p><p>问题引起 &amp; 解决方案：请参阅<a href="#修复发生错误-请退出并重启">《修复发生错误，请退出并重启》</a>章节。</p><h2 id="长时间处于-正在修复中" tabindex="-1">长时间处于“正在修复中...” <a class="header-anchor" href="#长时间处于-正在修复中" aria-label="Permalink to &quot;长时间处于“正在修复中...”&quot;">​</a></h2><p>问题图例：</p><p><img src="'+d+'" alt=""></p><p>问题引起 &amp; 解决方案：请参阅<a href="#修复发生错误-请退出并重启">《修复发生错误，请退出并重启》</a>章节。</p><h2 id="修复发生错误-请退出并重启" tabindex="-1">修复发生错误，请退出并重启 <a class="header-anchor" href="#修复发生错误-请退出并重启" aria-label="Permalink to &quot;修复发生错误，请退出并重启&quot;">​</a></h2><p>问题图例：</p><p><img src="'+h+'" alt=""></p><p>问题引起：</p>',13),I=s("li",null,[s("p",null,"未安装 Microsoft Edge WebView2。")],-1),G=s("li",null,[s("p",null,"Microsoft Edge Webview2 安装时弹出的 UAC 弹窗未授权。")],-1),J=s("li",null,[s("p",null,"Microsoft Edge WebView2 和（或）Microsoft Edge 版本过旧。")],-1),Q=s("li",null,[s("p",null,"你的网络环境较差，或微软电脑管家主程序无法联网，导致与 Microsoft 通信不佳。")],-1),O=s("li",null,[s("p",null,"其它原因。")],-1),L=i('<p>解决方案：（请先 <strong>退出微软电脑管家主程序</strong>）</p><ol><li><p>请尝试 <a href="https://go.microsoft.com/fwlink/?linkid=2124701" target="_blank" rel="noreferrer">下载 Microsoft Edge WebView2</a> 并安装。（需要右键安装程序，选择<code>以管理员身份运行</code>）</p></li><li><p>请尝试重新修复，并直接点击<code>是</code>。</p></li></ol><p><img src="'+m+'" alt=""></p><ol start="3"><li>请尝试以下步骤以修复 Microsoft Edge WebView2 Runtime：</li></ol><p>a. 按下 WIN + R，输入 <a href="ms-settings:appsfeatures">ms-settings:appsfeatures</a> 并回车。</p><p>b. 在列表中找到名为 <code>Microsoft Edge WebView2 Runtime</code> 的程序，并点击旁边的 <code>...</code>，再点击<code>修改</code>。</p><p><img src="'+g+'" alt=""></p><p>c. 点击修改后，安装程序会出现以下弹窗，点击<code>修复</code>后，安装程序将自动联网下载并重新安装 Microsoft Edge WebView2。</p><p><img src="'+_+'" alt=""></p><p>d. 启动微软电脑管家。</p><ol start="4"><li><p>请参阅<a href="./../appendix/change-DNS.html#如何更换-dns">《如何更换 DNS》</a></p></li><li><p>需要先判断自己是否有安装 Microsoft Edge WebView2，步骤如下：</p></li></ol><p>a. 按下 WIN + R，输入 <a href="ms-settings:appsfeatures">ms-settings:appsfeatures</a> 并回车。</p><p>b. 在列表中找到名为 <code>Microsoft Edge WebView2 Runtime</code> 的程序。</p><p><img src="'+k+'" alt=""></p><p>c. 若已经安装，请重复 3. 的步骤；若未安装，请重复 1. 的步骤。</p><ol start="6"><li>请参阅<a href="./../problem-solving/EdgeWebView2.html#microsoft-edge-webview-2-runtime-安装程序无法打开">《Microsoft Edge WebView 2 Runtime 安装程序无法打开》</a>的章节说明。</li></ol><p>若依旧报错，请先参阅<a href="./../appendix/submit-advice-n-feedback.html">《提交日志》</a>，再转到<a href="./../appendix/repair-system-image.html#镜像修复">《如何使用镜像对 Windows 进行修复》</a>。</p><h2 id="我们这边出了错" tabindex="-1">我们这边出了错 <a class="header-anchor" href="#我们这边出了错" aria-label="Permalink to &quot;我们这边出了错&quot;">​</a></h2><p>问题图例：</p><p><img src="'+f+'" alt=""></p><p>问题引起 &amp; 解决方案：请参阅<a href="#下载失败-请重试">《下载失败，请重试》</a>章节。</p><h2 id="下载失败-请重试" tabindex="-1">下载失败，请重试 <a class="header-anchor" href="#下载失败-请重试" aria-label="Permalink to &quot;下载失败，请重试&quot;">​</a></h2><p>问题图例：</p><p><img src="'+u+'" alt=""></p><p>问题引起：</p><ol><li><p>微软电脑管家正式版与微软电脑管家公测版冲突。</p></li><li><p>你的网络环境较差，或微软电脑管家主程序无法联网，导致与 Microsoft 通信不佳。</p></li></ol><p>解决方案：（请先 <strong>退出微软电脑管家主程序</strong>）</p><ol><li>卸载微软电脑管家公测版，并以管理员身份运行终端或 PowerShell，输入以下命令：</li></ol><div class="language-PowerShell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">PowerShell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-AppxPackage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AllUsers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> where-object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Microsoft.MicrosoftPCManager&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Remove-AppxPackage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AllUsers</span></span></code></pre></div><ol start="2"><li>请参阅<a href="./../appendix/change-DNS.html#如何更换-dns">《如何更换 DNS》</a></li></ol><div class="warning custom-block"><p class="custom-block-title">警告</p><p>微软电脑管家公测版即将结束支持，请在 <a href="https://www.microsoft.com/store/productid/9PM860492SZD" target="_blank" rel="noreferrer">Microsoft Store</a> 或 WinGet 下载最新版。 如果你的设备没有 Microsoft Store 或 WinGet，可以从 <a href="https://gbcs6-my.sharepoint.com/:f:/g/personal/gucats_gbcs6_onmicrosoft_com/EoscJOQ9taJFtx9LZLPiBM0BEmVm7wsLuJOuHnwmo9EQ5w?e=QWoXaL" target="_blank" rel="noreferrer">OneDrive</a> 或群文件中获取微软电脑管家最新正式版。</p></div><h2 id="电脑管家服务加载失败" tabindex="-1">电脑管家服务加载失败 <a class="header-anchor" href="#电脑管家服务加载失败" aria-label="Permalink to &quot;电脑管家服务加载失败&quot;">​</a></h2><p>问题图例：</p><p><img src="'+E+'" alt=""></p><p>问题引起 &amp; 解决方案：请参阅<a href="#无法完成当前操作">《无法完成当前操作》</a>章节。</p><h2 id="无法完成当前操作" tabindex="-1">无法完成当前操作 <a class="header-anchor" href="#无法完成当前操作" aria-label="Permalink to &quot;无法完成当前操作&quot;">​</a></h2><p>问题图例：</p><p><img src="'+b+'" alt=""></p><p>解决方案：</p><ol><li><p>按下 WIN + R，输入 services.msc 并回车</p></li><li><p>找到名为 <code>PCManager Service (Store)</code> 的服务，右键选择<code>重新启动(E)</code>。（或者是<code>启动(S)</code>）</p></li></ol><p><img src="'+w+'" alt=""></p><p><img src="'+B+'" alt=""></p><ol start="3"><li>尝试重新运行<code>垃圾清理</code>任务。</li></ol><p><img src="'+W+'" alt=""></p>',44),U=s("a",{href:"./../appendix/submit-advice-n-feedback.html"},"《提交日志》",-1),j=s("strong",null,"完全卸载后再重新安装重试",-1),$=i('<h2 id="微软电脑管家无法安装" tabindex="-1">微软电脑管家无法安装 <a class="header-anchor" href="#微软电脑管家无法安装" aria-label="Permalink to &quot;微软电脑管家无法安装&quot;">​</a></h2><p>问题现象：使用微软电脑管家公测版后，无法通过 Microsoft Store 或 WinGet 升级到微软电脑管家正式版，且卸载后问题依旧。</p><p>解决方案：</p><ol><li><p>卸载微软电脑管家公测版。</p></li><li><p>按下 WIN + X 打开开始菜单高级菜单，并选择<code>终端管理员</code>（请确保运行的是 PowerShell）或<code>Windows PowerShell (管理员)</code>。</p></li></ol><p><img src="'+F+'" alt=""></p><ol start="3"><li>在里面输入以下命令，完成后重启计算机。</li></ol><div class="language-PowerShell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">PowerShell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-AppxPackage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AllUsers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> where-object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Microsoft.MicrosoftPCManager&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Remove-AppxPackage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AllUsers</span></span></code></pre></div><h2 id="windows-工具选项缺少" tabindex="-1">Windows 工具选项缺少 <a class="header-anchor" href="#windows-工具选项缺少" aria-label="Permalink to &quot;Windows 工具选项缺少&quot;">​</a></h2><p>问题图例：</p><p>Windows 11：</p><p><img src="'+S+'" alt=""></p><p>Windows 10：</p><p><img src="'+C+'" alt=""></p><p>其它缺少对应功能的 Windows：</p><p><img src="'+y+'" alt=""></p><p>微软电脑管家公测版：</p><p><img src="'+P+'" alt=""></p><p>问题引起：There is no corresponding in-box app(s) on the system, missing features, or currently using Microsoft PC Manager Beta.</p><p>解决方案：</p><ol><li><p>升级系统至 <a href="https://aka.ms/DownloadWindows11" target="_blank" rel="noreferrer">Windows 11</a>，或补全缺失的系统 WindowsApps 应用。（<a href="https://support.microsoft.com/windows/%E4%BD%BF%E7%94%A8%E5%AE%9E%E6%97%B6%E5%AD%97%E5%B9%95%E6%9B%B4%E5%A5%BD%E5%9C%B0%E4%BA%86%E8%A7%A3%E9%9F%B3%E9%A2%91-b52da59c-14b8-4031-aeeb-f6a47e6055df" target="_blank" rel="noreferrer">实时字幕</a> 在 Windows 11 22H2 及更高版本中提供）</p></li><li><p>如果当前正在使用微软电脑管家公测版，请在卸载后从 <a href="https://www.microsoft.com/store/productid/9PM860492SZD" target="_blank" rel="noreferrer">Microsoft Store</a> 或 WinGet 下载最新版。如果你的设备没有 Microsoft Store 或 WinGet，可以从 <a href="https://gbcs6-my.sharepoint.com/:f:/g/personal/gucats_gbcs6_onmicrosoft_com/EoscJOQ9taJFtx9LZLPiBM0BEmVm7wsLuJOuHnwmo9EQ5w?e=QWoXaL" target="_blank" rel="noreferrer">OneDrive</a> 或群文件中获取微软电脑管家最新正式版。</p></li></ol><h2 id="没有注册类" tabindex="-1">没有注册类 <a class="header-anchor" href="#没有注册类" aria-label="Permalink to &quot;没有注册类&quot;">​</a></h2><p>问题图例：</p><p><img src="'+M+'" alt=""></p><p>问题引起：未知。目前仅从 Microsoft Store 或 WinGet 下载的微软电脑管家有该问题。</p><p>解决方案：（方法二选一）</p><ol><li><p>通过 Microsoft Store 或 WinGet 升级电脑管家版本到 3.3.14.0 或更高版本。</p></li><li><p>打开<code>设置</code> &gt; <code>基本设置</code>，并关闭 <code>Windows 启动时自动运行电脑管家</code>，然后重启两次计算机即可。</p></li></ol><p><img src="'+D+'" alt=""></p><h2 id="屏蔽应用内不想要的更新项" tabindex="-1">屏蔽应用内不想要的更新项 <a class="header-anchor" href="#屏蔽应用内不想要的更新项" aria-label="Permalink to &quot;屏蔽应用内不想要的更新项&quot;">​</a></h2><p>问题图例：</p><p><img src="'+A+'" alt=""></p><ol><li><p>从 Microsoft 下载 <a href="http://download.microsoft.com/download/F/2/2/F22D5FDB-59CD-4275-8C95-1BE17BF70B21/wushowhide.diagcab" target="_blank" rel="noreferrer">wushowhide.diagcab</a> 并打开。</p></li><li><p>点击<code>下一步(N)</code>。</p></li></ol><p><img src="'+v+'" alt=""></p><p>选择 <code>Hide updates</code>。</p><p><img src="'+x+'" alt=""></p><ol start="3"><li>勾选你需要屏蔽的更新，并点击<code>下一步(N)</code>。</li></ol><p><img src="'+V+'" alt=""></p><p>等待工具完成疑难解答。</p><p><img src="'+q+'" alt=""></p><ol start="4"><li>完成后关闭疑难解答工具即可。应用内不会再次出现已屏蔽的更新。</li></ol><p><img src="'+T+'" alt=""></p><ol start="5"><li>请注意，此工具同时在 Windows 更新中也会屏蔽对应更新，也请不要删除 <code>C:\\Windows\\SoftwareDistribution</code> 目录下除 <code>Download</code> 文件夹之外的文件或文件夹，否则会失效。如果需要再次显示某个更新，请在疑难解答工具的步骤二时选择 <code>Show updates</code> 并执行下一步的操作。</li></ol>',41);function z(X,Z,H,K,Y,ss){const a=r("font");return n(),l("div",null,[R,s("ol",null,[I,G,J,Q,s("li",null,[t(a,{color:"red"},{default:o(()=>[e("注册表引起的 Microsoft Edge (WebView 2 Runtime) 安装程序错误。")]),_:1})]),O]),L,s("p",null,[e("若报错依旧，请参阅"),U,e("，把你收集到的日志、转储文件、问题截图以及系统版本一并发给我们，后续可能会需要你来协助我们修复。"),t(a,{color:"red"},{default:o(()=>[e("完成后将微软电脑管家"),j]),_:1}),e("。")]),$])}const as=p(N,[["render",z]]);export{is as __pageData,as as default};
